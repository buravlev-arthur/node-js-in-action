# Фреймворки на стороне сервера

Node.js-фреймворков для сервера существует большое колличество.

## Примеры NodeJS фреймворков

- [hapi](https://hapi.dev/) - подходит для написания микросервисов
- [Express](https://expressjs.com/) - подходит для более крупных проектов
- [Sails.js](https://sailsjs.com/) - подходит, например, для компонента электронной коммерции

Часто для обширного проекта применяется сразу несколько таких фреймворков. Каждый для своей задачи.

**Виды библиотек и фреймворков**:

- _API-фреймворк_ - библиотека для построения API. Пример: [LoopBack](https://loopback.io/);
- _Библиотека HTTP-сервера_ - строят приложения на основе команд и машрутов HTTP. Пример [Koa](https://koajs.com/);
- _Фреймворк HTTP-сервера_ - строит модульные сервера, использующих HTTP для коммуникации. Пример: [hapi](https://hapi.dev/);
- _Веб-фреймворк MVC_ - фреймворки на базе паттерна MVC. Пример: [Sails.js](https://sailsjs.com/);
- _Полностековый фреймворк_ - используют JavaScript на стороне сервера и браузера и позволяют использовать совместно клиентский
  и серверный код (_изоморфтный код_). Пример: [DerbyJS](https://w.derbyjs.com/).

## Koa V1

Koa (версии 1) базируется на _Express_, но использует [генераторы](https://learn.javascript.ru/generators) (синтаксис ES2015) для определения функций промежуточной обработки (мидлваров).
Это позволяет писать практически синхронный код.

**Пример синтаксиса генераторов в JavaScript**: ./koa-example/generators.js
**Пример Koa-сервера версии 1 (генераторы)**: ./koa-example/index.js
**Пример использования koa-router**: ./koa-example/router.js

**Плюсы**: гибкая настройка за счёт расширения на основе множества миддлваров.

**Минусы**: трудоёмкость переноса функционала между проектами (повторого использования кода).

## Kraken

_Kraken_ базируется на Express, но за счёт модулей расширяет функционал. Самый популярный модуль - [Lusca](https://github.com/krakenjs/lusca), который
обеспечивает безопастность. Кроме того, _Kraken_ устанавливает более жёсткую структуру приложения в отличии от _Koa_ и _Express_.
_Kraken_ использует паттерн MVC и настраивается через файлы конфигурации.

**Плюсы**: строгая структура проекта. Структура так же однотипная от проекта к проекту (за счёт авто-генерации проекта). Встроенные шаблонизатор _Dust_ и интернационализация (Makara) позволяют легко создавать мультиязычные шаблоны.

**Минусы**: конфигурация проекта через файлы конфигурации, что обеспечивает плохую прозрачность при настройке. Сложность в изучении.

**Пример минимальной конфигурации проекта Kraken**: ./kraken-example

## hapi

_hapi_ берет сервер как главную абстрацию. Позволяет связывать несколько сервером посредством HTTP (микросервисная архитектура). Поддерживает API маршрутизации. Не обеспечивает поддержки на стороне клиента и баз данных. Удобен для задач DevOps (подключения, ведение журнала).

_hapi_ расширяется за счёт плагинов. В отличии от мидлваров в _Express_, плагины в _hapi_ расширяют функции сервера.

Плагин _inert_ - добавляет поддержку статики, обработчики каталогов.
Плагин _hapi-sequelizejs_ - позволяет генерировать REST API на основании ORM-моделей [Sequelize](https://sequelize.org/docs/v6/) баз данных.

**Плюсы**: более выразительный синтаксис плагинов, возможность разбиения сервера на кластеры (микросервисы).

**Минусы**: зависимость от множества плагинов (могут перестать поддерживаться), отсутствие структуры в проекта (в сравнении, например, с _Kraken_).
